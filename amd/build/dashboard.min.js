define("local_sitsgradepush/dashboard",["exports","./push_tasks","core/notification"],(function(_exports,_push_tasks,_notification){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=(obj=_notification)&&obj.__esModule?obj:{default:obj};async function pushgrade(button){try{let assessmentmappingid=button.getAttribute("data-assessmentmappingid"),result=await(0,_push_tasks.schedulePushTask)(assessmentmappingid);if(result.success){button.parentNode.parentNode.querySelector("span:last-child").innerHTML='<i class="fa-solid fa-hourglass-start" data-toggle="tooltip" data-placement="top" title="'+result.status+'"></i>',button.disabled=!0;let tooltipid=button.getAttribute("aria-describedby");null!==tooltipid&&null!==document.getElementById(tooltipid)&&document.getElementById(tooltipid).remove()}else{let errormessagerow=document.createElement("tr");errormessagerow.setAttribute("class","error-message-row"),errormessagerow.innerHTML='<td colspan="6>"><div class="alert alert-danger" role="alert">'+result.message+"</div></td>";let currentrow=button.closest("tr");null!==currentrow.nextElementSibling&&currentrow.nextElementSibling.classList.contains("error-message-row")&&currentrow.nextElementSibling.remove(),currentrow.insertAdjacentElement("afterend",errormessagerow)}return result.success}catch(error){return window.console.error(error),!1}}_exports.init=()=>{let page=document.getElementById("page"),tableSelector=document.getElementById("module-delivery-selector");tableSelector.addEventListener("change",(function(){let selectedTable=document.getElementById(tableSelector.value);if(selectedTable){let offset=-100,tablePosition=selectedTable.getBoundingClientRect().top,scrollPosition=page.scrollTop+tablePosition+offset;page.scrollTo({top:scrollPosition,behavior:"smooth"})}}));let backToTopButton=document.getElementById("backToTopButton");page.addEventListener("scroll",(function(){page.scrollTop>=100?backToTopButton.style.display="block":backToTopButton.style.display="none"})),backToTopButton.addEventListener("click",(function(){page.scrollTo({top:0,behavior:"smooth"}),tableSelector.selectedIndex=0})),document.querySelectorAll(".push-mark-button:not([disabled])").forEach((function(button){button.addEventListener("click",(function(){pushgrade(this)}))})),document.getElementById("push-all-button").addEventListener("click",(async function(){let mabpushbuttons=document.querySelectorAll(".push-mark-button:not([disabled])"),total=mabpushbuttons.length,count=0,promises=[];mabpushbuttons.forEach((function(button){let promise=pushgrade(button).then((function(result){return result&&(count+=1),result})).catch((function(error){window.console.error(error)}));promises.push(promise)})),await Promise.all(promises),page.scrollTo({top:0,behavior:"instant"}),_notification.default.addNotification({message:count+" of "+total+" push tasks have been scheduled.",type:count===total?"success":"warning"})}))}}));

//# sourceMappingURL=dashboard.min.js.map