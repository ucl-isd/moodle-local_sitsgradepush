define("local_sitsgradepush/select_source",["exports","./table_helper","core/notification","core/modal_events","core/modal_save_cancel","./sitsgradepush_helper"],(function(_exports,_table_helper,_notification,_modal_events,_modal_save_cancel,_sitsgradepush_helper){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=_interopRequireDefault(_notification),_modal_events=_interopRequireDefault(_modal_events),_modal_save_cancel=_interopRequireDefault(_modal_save_cancel);function getModalBody(type,name,endDate,mapcode,mabseq){return'\n    <div class="modal-body">\n      <p>Confirm you want to return marks from:</p>\n      <table class="table table-hover table-bordered">\n        <thead style="background-color: lightgrey">\n          <th>Type</th>\n          <th>Name</th>\n          <th>End Date</th>\n        </thead>\n        <tr>\n          <td>'.concat(type,"</td>\n          <td>").concat(name,"</td>\n          <td>").concat(endDate,'</td>\n        </tr>\n      </table>\n      <p>to</p>\n      <table class="table table-hover table-bordered">\n        <thead style="background-color: lightgrey">\n          <th>MAB</th>\n          <th>SEQ</th>\n        </thead>\n        <tr>\n          <td>').concat(mapcode,"</td>\n          <td>").concat(mabseq,"</td>\n        </tr>\n      </table>\n    </div>")}_exports.init=()=>{(0,_table_helper.tableHelperInit)("existing-activity-table",2,"filterInput");let selectAssessmentButtons=document.querySelectorAll(".select-assessment-button");selectAssessmentButtons&&selectAssessmentButtons.forEach((function(button){button.addEventListener("click",(function(){(async function(button){let mapcode=button.getAttribute("data-mapcode"),mabseq=button.getAttribute("data-mabseq"),mabid=button.getAttribute("data-mabid"),courseid=button.getAttribute("data-courseid"),sourcetype=button.getAttribute("data-sourcetype"),sourceid=button.getAttribute("data-sourceid"),reassess=button.getAttribute("data-reassess"),partid=button.getAttribute("data-partid"),currentrow=button.closest("tr"),type=currentrow.getElementsByTagName("td")[0].innerHTML,name=currentrow.getElementsByTagName("td")[1].innerHTML,endDate=currentrow.getElementsByTagName("td")[3].innerHTML;const modal=await _modal_save_cancel.default.create({title:"Confirmation",body:getModalBody(type,name,endDate,mapcode,mabseq),large:!0,buttons:{save:"Confirm",cancel:"Cancel"}});await modal.show(),modal.getRoot().on(_modal_events.default.save,(()=>{(0,_sitsgradepush_helper.mapAssessment)(courseid,sourcetype,sourceid,mabid,reassess,partid).then((result=>{if(result.success){localStorage.setItem("successMessage",result.message);let url="/local/sitsgradepush/dashboard.php?id="+courseid;"1"===reassess&&(url+="&reassess="+reassess),window.location.href=url}else _notification.default.addNotification({message:result.message,type:"error"});return result})).catch((error=>{window.console.error(error)}))}))})(button).then((result=>result)).catch((error=>{_notification.default.addNotification({message:error.message,type:"error"}),window.console.error(error)}))}))}))}}));

//# sourceMappingURL=select_source.min.js.map