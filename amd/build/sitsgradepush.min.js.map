{"version":3,"file":"sitsgradepush.min.js","sources":["../src/sitsgradepush.js"],"sourcesContent":["import Ajax from 'core/ajax';\nimport notification from 'core/notification';\n\nexport const init = (coursemoduleid) => {\n    // Get the push button.\n    let pushbuton = document.getElementById('local_sitsgradepush_pushbutton_async');\n\n    // Exit if the push button is not found.\n    if (pushbuton === null) {\n        return;\n    }\n\n    // Add an event listener to the push button.\n    pushbuton.addEventListener('click', (e) => {\n        e.preventDefault();\n        // Schedule a task to push grades to SITS.\n        schedulePushTask(coursemoduleid);\n    });\n};\n\n/**\n * Schedule a task to push grades to SITS.\n * @param {int} coursemoduleid\n */\nfunction schedulePushTask(coursemoduleid) {\n    Ajax.call([{\n        methodname: 'local_sitsgradepush_schedule_push_task',\n        args: {\n            'coursemoduleid': coursemoduleid,\n        },\n    }])[0].done(function(response) {\n        notification.addNotification({\n            message: response.message,\n            type: response.success ? 'success' : 'warning'\n        });\n        if (response.success) {\n            // Get the push button.\n            let pushbuton = document.getElementById('local_sitsgradepush_pushbutton_async');\n\n            // Update the button text.\n            pushbuton.innerHTML = response.status;\n\n            // Disable the push button after scheduled push task successfully.\n            pushbuton.disabled = true;\n        }\n    }).fail(function(err) {\n        window.console.log(err);\n    });\n}\n"],"names":["coursemoduleid","pushbuton","document","getElementById","addEventListener","e","preventDefault","call","methodname","args","done","response","addNotification","message","type","success","innerHTML","status","disabled","fail","err","window","console","log","schedulePushTask"],"mappings":"oYAGqBA,qBAEbC,UAAYC,SAASC,eAAe,wCAGtB,OAAdF,WAKJA,UAAUG,iBAAiB,SAAUC,IACjCA,EAAEC,0BAUgBN,8BACjBO,KAAK,CAAC,CACPC,WAAY,yCACZC,KAAM,gBACgBT,mBAEtB,GAAGU,MAAK,SAASC,mCACJC,gBAAgB,CACzBC,QAASF,SAASE,QAClBC,KAAMH,SAASI,QAAU,UAAY,YAErCJ,SAASI,QAAS,KAEdd,UAAYC,SAASC,eAAe,wCAGxCF,UAAUe,UAAYL,SAASM,OAG/BhB,UAAUiB,UAAW,MAE1BC,MAAK,SAASC,KACbC,OAAOC,QAAQC,IAAIH,QA9BnBI,CAAiBxB"}