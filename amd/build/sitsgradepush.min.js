define("local_sitsgradepush/sitsgradepush",["exports","./sitsgradepush_helper","core/notification"],(function(_exports,_sitsgradepush_helper,_notification){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=(obj=_notification)&&obj.__esModule?obj:{default:obj};_exports.init=(coursemoduleid,mappingids)=>{let pushbuton=document.getElementById("local_sitsgradepush_pushbutton_async");if(null===pushbuton)return;let promises=[];pushbuton.addEventListener("click",(async e=>{e.preventDefault();let total=mappingids.length,count=0;mappingids.forEach((function(mappingid){let promise=(0,_sitsgradepush_helper.schedulePushTask)(mappingid).then((function(result){let taskstatus=document.getElementById("taskstatus-"+mappingid);if(result.success)count+=1,taskstatus.innerHTML='<i class="fa-solid fa-hourglass-start"></i> '+result.status;else{let errormessagerow=document.createElement("tr");errormessagerow.setAttribute("class","error-message-row"),errormessagerow.innerHTML='<td colspan="6>"><div class="alert alert-danger" role="alert">'+result.message+"</div></td>";let currentrow=taskstatus.closest("tr");null!==currentrow.nextElementSibling&&currentrow.nextElementSibling.classList.contains("error-message-row")&&currentrow.nextElementSibling.remove(),currentrow.insertAdjacentElement("afterend",errormessagerow)}return result.success})).catch((function(error){window.console.error(error)}));promises.push(promise)})),await Promise.all(promises),_notification.default.addNotification({message:count+" of "+total+" push tasks have been scheduled.",type:count===total?"success":"warning"})}))}}));

//# sourceMappingURL=sitsgradepush.min.js.map